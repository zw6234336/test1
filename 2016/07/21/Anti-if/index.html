<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>减少IF | 张伟的博客</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">减少IF</h1><a id="logo" href="/.">张伟的博客</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">减少IF</h1><div class="post-meta">Jul 21, 2016<span> | </span><span class="category"><a href="/categories/技术/">技术</a></span></div><div class="post-content"><p> 原文已经收入到笔记中名称是Anti-If: The missing patterns</p>
<p>Around 10 years ago I encountered the anti-if campaign and found it to be an absurd concept. How on earth would you make a useful program without using an if statement? Preposterous.</p>
<blockquote>
<p>大概十年前我遇到if这种模式，并且发现他是毫无价值的想法。<br>你究竟要怎样才能不用if创造一个十分有用的代码。</p>
</blockquote>
<p>But then it gets you thinking. Do you remember that heavily nested code you had to understand last week? That kinda sucked right? If only there was a way to make it simpler.</p>
<blockquote>
<p>但是仔细想想，你还记得那些重度嵌套的代码吗？那种正确吗？<br>是不是有一种相似的方法呢？</p>
</blockquote>
<p>The anti-if campaign site is sadly low on practical advice. This post intends to remedy that with a collection of patterns you can adopt when the need arises. But first let’s look at the problem that if statements pose.</p>
<blockquote>
<p>if模式是一个非常不好的实践建议，用集合的方式去积极的补救，<br>看一下if场景。</p>
</blockquote>
<h4 id="The-problems-of-if-statements"><a href="#The-problems-of-if-statements" class="headerlink" title="The problems of if statements"></a>The problems of if statements</h4><p>The first problem with if statements is that they often make it easy to modify code in bad ways. Let’s start with the birth of a new if statement:</p>
<blockquote>
<p>第一个问题，使用if会导致采用不正确的方式去修改代码。<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">theProblem</span><span class="params">(<span class="keyword">boolean</span> someCondition)</span> </span>&#123;</div><div class="line">       <span class="comment">// SharedState</span></div><div class="line"></div><div class="line">       <span class="keyword">if</span>(someCondition) &#123;</div><div class="line">           <span class="comment">// CodeBlockA</span></div><div class="line">       &#125; <span class="keyword">else</span> &#123;</div><div class="line">           <span class="comment">// CodeBlockB</span></div><div class="line">       &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>This isn’t too bad at this point, but we’ve already given us some problems. When I read this code I have to check how CodeBlockA and CodeBlockB are modifying the same SharedState. This can be easy to read at first but can become difficult as the CodeBlocks grow and the coupling becomes more complicated.</p>
<blockquote>
<p>这是看起来还不错，但是已经有几个问题了，第一个我可能同时修改A块和B块。<br>这个可能开始很好阅读。但是最后随着代码块的增长，越来越多的耦合变得更加复杂。</p>
</blockquote>
<p>You’ll often see the above CodeBlocks abused with further nested if statements and local returns. Making it hard to see what the business logic is through the routing logic.</p>
<blockquote>
<p>你会经常看到这些代码块中会嵌套更多的if和返回值。使得阅读代码逻辑非常困难。</p>
</blockquote>
<p>The second problem with if statements is when they are duplicated. This means means a domain concept is missing. It’s all too easy to increase coupling by bringing things together than don’t need to be. Making code harder to read and change.</p>
<blockquote>
<p>第二个问题当这些if地方被复制的时候。那就意味着这个领域概念丢失了。<br>这样容易导致很多并不需要的东西进行耦合。使得代码阅读更加困难。</p>
</blockquote>
<p>The third problem with if statements is that you have to simulate execution in your own head. You must beome a mini-computer. That’s taking away from your mental energy, energy that would be better spent thinking about solving the problem, rather than how the intracate code branches weave together.</p>
<blockquote>
<p>第三个问题。在这样的状态下你不得不去用你的头脑去模拟执行。<br>你变成了一个小型电脑，大脑是用来解决问题的而不是用来执行代码的。</p>
</blockquote>
<p>I want to get to the point of telling you patterns we can do instead, but first a word of warning.</p>
<blockquote>
<p>我想让你知道新模式的重点。但是先警告一下。</p>
</blockquote>
<h4 id="Moderation-in-all-things-especially-moderation"><a href="#Moderation-in-all-things-especially-moderation" class="headerlink" title="Moderation in all things, especially moderation"></a>Moderation in all things, especially moderation</h4><blockquote>
<p>任何事情都有一个度</p>
</blockquote>
<p>If statements usually make your code more complicated. But we don’t want to outright ban them. I’ve seen some pretty heinous code created with the goal of removing all traces of if statements. We want to avoid falling into that trap.</p>
<blockquote>
<p>如果这个状态让你的代码更加复杂。我们并不建议你完全这样用。<br>我曾经看到用这种方式及其错误编码方式。移除所有的if判断。我们都想去避免陷入这种圈套。</p>
</blockquote>
<p>For each pattern we’ll read about I’m going to give you a tolerance value for when to use it.</p>
<blockquote>
<p>对于每个我们将要读到的模式我都会给你一个有限的建议。</p>
</blockquote>
<p>A single if statement which isn’t duplicated anywhere else is probably fine. It’s when you have duplicated if statements that you want your spider sense to be tingling.</p>
<blockquote>
<p>一个单独的if语句块并不是拷到任何地方可能都是合适的。一旦拷贝了可能意义就不对了。</p>
</blockquote>
<p>At the outside of your code base, where you talk to the dangerous outside world, you are going to want to validate incoming responses and change your beahaviour accordingly. But inside our own codebases, where we behind those trusted gatekeepers, I think we have a great opportunity to use simple, richer and more powerful alternatives.</p>
</div><div class="tags"><a href="/tags/java基础/">java基础</a></div><div class="post-nav"><a href="/2016/07/21/日志/" class="pre">日志</a><a href="/2016/06/07/代码生成分析/" class="next">代码生成分析</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://zw6234336.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/日志/">日志</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/设计/">设计</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/java基础/" style="font-size: 15px;">java基础</a> <a href="/tags/读书/" style="font-size: 15px;">读书</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/maven/" style="font-size: 15px;">maven</a> <a href="/tags/Mybatis/" style="font-size: 15px;">Mybatis</a> <a href="/tags/Mysql/" style="font-size: 15px;">Mysql</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/文件存储/" style="font-size: 15px;">文件存储</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/其他/" style="font-size: 15px;">其他</a> <a href="/tags/java-hashmap/" style="font-size: 15px;">java hashmap</a> <a href="/tags/jenkins/" style="font-size: 15px;">jenkins</a> <a href="/tags/eclipse-svn/" style="font-size: 15px;">eclipse-svn</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/业务/" style="font-size: 15px;">业务</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/11/07/hexo2github/">hexo搭建github个人主页</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/07/jetty/">svn</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/07/JavaNaming/">JAVA实用命名规则</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/07/HttpClientPool/">org.apache.commons.httpclient学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/07/demete/">Demeter</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/07/hello-world/">Hello World</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/30/redWar/">抢红包</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/10/how-hashmap-works-in-java/">How hashmap works in java</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/28/FastDFS/">FastDFS分布式存储</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/13/SLF4J-manual/">SLF4J日志文档翻译</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">张伟的博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>